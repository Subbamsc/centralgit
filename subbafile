This version2 -code has been modified
